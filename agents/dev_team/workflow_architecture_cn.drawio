<mxGraphModel>
  <root>
    <mxCell id="0"/>
    <mxCell id="1" parent="0"/>
    
    <!-- 标题 -->
    <mxCell id="title" value="Dev Team 多智能体协作工作流架构" style="text;strokeColor=none;fillColor=none;html=1;fontSize=24;fontStyle=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;fontFamily=阿里巴巴普惠体 Bold" vertex="1" parent="1">
      <mxGeometry x="250" y="20" width="500" height="40" as="geometry"/>
    </mxCell>

    <!-- 阶段 1：战略规划 -->
    <mxCell id="phase1" value="第一阶段：战略规划 (Architect)" style="swimlane;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;startSize=30;rounded=1;shadow=1;fontFamily=思源黑体 Medium" vertex="1" parent="1">
      <mxGeometry x="40" y="80" width="300" height="420" as="geometry"/>
    </mxCell>
    
    <mxCell id="p1_start" value="用户原始需求" style="ellipse;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;fontStyle=1;fontFamily=思源宋体 Regular" vertex="1" parent="phase1">
      <mxGeometry x="90" y="45" width="120" height="50" as="geometry"/>
    </mxCell>
    
    <mxCell id="p1_planner" value="架构师 / 任务规划器&#xa;(需求分析)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;fontFamily=思源宋体 Regular" vertex="1" parent="phase1">
      <mxGeometry x="70" y="130" width="160" height="60" as="geometry"/>
    </mxCell>
    
    <mxCell id="p1_brainstorm" value="头脑风暴 &amp; ADR&#xa;(设计审查)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;fontFamily=思源宋体 Regular" vertex="1" parent="phase1">
      <mxGeometry x="70" y="220" width="160" height="60" as="geometry"/>
    </mxCell>
    
    <mxCell id="p1_jd" value="生成角色说明 &amp; JD&#xa;(智能体配置)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;fontFamily=思源宋体 Regular" vertex="1" parent="phase1">
      <mxGeometry x="70" y="320" width="160" height="60" as="geometry"/>
    </mxCell>

    <!-- 阶段 1 连线 -->
    <mxCell id="e1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeColor=#333333;" edge="1" parent="phase1" source="p1_start" target="p1_planner"><mxGeometry relative="1" as="geometry"/></mxCell>
    <mxCell id="e2" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeColor=#333333;" edge="1" parent="phase1" source="p1_planner" target="p1_brainstorm"><mxGeometry relative="1" as="geometry"/></mxCell>
    <mxCell id="e3" value="已验证设计" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeColor=#333333;fontFamily=思源宋体 Regular" edge="1" parent="phase1" source="p1_brainstorm" target="p1_jd"><mxGeometry relative="1" as="geometry"/></mxCell>

    <!-- 阶段 2：动态协作 -->
    <mxCell id="phase2" value="第二阶段：动态协作 (Commander)" style="swimlane;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;startSize=30;rounded=1;shadow=1;fontFamily=思源黑体 Medium" vertex="1" parent="1">
      <mxGeometry x="400" y="80" width="560" height="420" as="geometry"/>
    </mxCell>
    
    <mxCell id="p2_init" value="指挥官初始化&#xa;(团队组建)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;fontStyle=1;fontFamily=思源宋体 Regular" vertex="1" parent="phase2">
      <mxGeometry x="20" y="50" width="180" height="60" as="geometry"/>
    </mxCell>
    
    <mxCell id="p2_detect" value="智能能力探测" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#333333;fontFamily=思源宋体 Regular" vertex="1" parent="phase2">
      <mxGeometry x="240" y="50" width="140" height="60" as="geometry"/>
    </mxCell>

    <mxCell id="p2_loop" value="核心协作循环" style="swimlane;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#82b366;dashed=1;fontFamily=思源宋体 Regular" vertex="1" parent="phase2">
      <mxGeometry x="20" y="140" width="520" height="200" as="geometry"/>
    </mxCell>

    <mxCell id="agent_dev" value="开发者智能体&#xa;(代码实现)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontFamily=思源宋体 Regular" vertex="1" parent="p2_loop">
      <mxGeometry x="20" y="40" width="140" height="60" as="geometry"/>
    </mxCell>

    <mxCell id="agent_qa" value="QA / 审查智能体&#xa;(质量验证)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontFamily=思源宋体 Regular" vertex="1" parent="p2_loop">
      <mxGeometry x="200" y="40" width="140" height="60" as="geometry"/>
    </mxCell>

    <mxCell id="consensus" value="共识引擎&#xa;(决策中心)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=思源宋体 Regular" vertex="1" parent="p2_loop">
      <mxGeometry x="360" y="40" width="140" height="60" as="geometry"/>
    </mxCell>

    <mxCell id="validator" value="交叉验证器&#xa;(质量门禁)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontFamily=思源宋体 Regular" vertex="1" parent="p2_loop">
      <mxGeometry x="200" y="130" width="140" height="50" as="geometry"/>
    </mxCell>

    <mxCell id="p2_output" value="最终交付报告 &amp; 代码" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#ffffff;strokeColor=#333333;fontFamily=思源宋体 Regular" vertex="1" parent="phase2">
      <mxGeometry x="360" y="360" width="180" height="40" as="geometry"/>
    </mxCell>

    <!-- 共享记忆 (圆柱形) -->
    <mxCell id="shared_mem" value="共享记忆存储&#xa;(统一上下文)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#e1d5e7;strokeColor=#9673a6;fontFamily=思源宋体 Regular" vertex="1" parent="1">
      <mxGeometry x="400" y="530" width="160" height="80" as="geometry"/>
    </mxCell>

    <!-- 全局连线 -->
    <mxCell id="e_p1_to_p2" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;strokeColor=#333333;fontStyle=1" edge="1" parent="1" source="p1_jd" target="p2_init"><mxGeometry relative="1" as="geometry"/></mxCell>
    
    <mxCell id="e4" value="" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;strokeColor=#333333;" edge="1" parent="phase2" source="p2_init" target="p2_detect"><mxGeometry relative="1" as="geometry"/></mxCell>
    <mxCell id="e5" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeColor=#333333;" edge="1" parent="phase2" source="p2_detect" target="p2_loop"><mxGeometry relative="1" as="geometry"/></mxCell>
    
    <mxCell id="e6" value="提交" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;strokeColor=#333333;fontFamily=思源宋体 Regular" edge="1" parent="p2_loop" source="agent_dev" target="agent_qa"><mxGeometry relative="1" as="geometry"/></mxCell>
    <mxCell id="e7" value="投票" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;strokeColor=#333333;fontFamily=思源宋体 Regular" edge="1" parent="p2_loop" source="agent_qa" target="consensus"><mxGeometry relative="1" as="geometry"/></mxCell>
    <mxCell id="e8" value="质量检查" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeColor=#333333;fontFamily=思源宋体 Regular" edge="1" parent="p2_loop" source="agent_qa" target="validator"><mxGeometry relative="1" as="geometry"/></mxCell>
    <mxCell id="e9" value="需修复" style="curved=1;endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=0.5;entryY=1;strokeColor=#ff0000;fontFamily=思源宋体 Regular" edge="1" parent="p2_loop" source="validator" target="agent_dev"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="100" y="160"/></Array></mxGeometry></mxCell>

    <mxCell id="e10" value="通过" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0.5;entryY=0;strokeColor=#333333;fontFamily=思源宋体 Regular" edge="1" parent="phase2" source="consensus" target="p2_output"><mxGeometry relative="1" as="geometry"/></mxCell>

    <!-- 记忆交互 -->
    <mxCell id="e_mem" value="读/写同步" style="endArrow=classic;startArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeColor=#9673a6;dashed=1;fontFamily=思源宋体 Regular" edge="1" parent="1" source="p2_loop" target="shared_mem"><mxGeometry relative="1" as="geometry"/></mxCell>

  </root>
</mxGraphModel>