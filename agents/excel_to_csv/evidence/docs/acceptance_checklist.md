# 验收清单
- 任务: excel_to_csv 模块重构与优化
- 日期: 2026-01-05

## 验收项
- [ ] **功能一致性**：重构后模块处理相同输入的输出（CSV文件内容、审计报告）必须与现有模块完全一致（通过自动化集成测试验证）。
- [ ] **性能达标**：使用标准测试集（单个Excel，10 sheets, 5万行/sheet, 20列），端到端耗时满足：skip_llm=false模式 < 90秒，skip_llm=true模式 < 30秒（起止点：从CLI命令执行开始到所有文件写入完成）。
- [ ] **并发安全**：并发处理功能正常工作，并实现了可配置的默认安全上限（如最大工作线程数不超过CPU核心数的2倍），无资源泄漏或竞争条件。
- [ ] **架构解耦**：成功实现UI层、核心业务逻辑层、配置管理层的清晰分离，模块间通过定义良好的接口通信。
- [ ] **配置持久化**：用户可通过UI或API将关键设置（输入输出路径、并发开关、LLM调用开关、并发上限等）保存为配置文件，并可在后续运行时加载应用。
- [ ] **CLI兼容性**：所有现有CLI参数及行为得到完整支持，无需修改外部调用脚本。
- [ ] **代码质量**：核心模块单元测试覆盖率不低于85%，代码通过Pylint等规范检查，无重大安全漏洞或代码异味。
- [ ] **交付物完整**：按要求产出审查产物、ADR文档、性能测试报告及更新后的API文档。
- [ ] **UI布局**：Streamlit UI严格按‘基础配置’、‘高级性能’、‘审计输出’三模块布局，信息组织清晰，无布局错乱或过度拥挤。
- [ ] **UI功能**：所有配置参数均可在UI中设置并生效。
- [ ] **运行时可视化**：UI组件能实时、准确地反映任务阶段、进度、耗时及输出文件统计（CSV数、审计报告数、最近更新）。
- [ ] **UI集成**：UI与重构后的核心逻辑模块集成无误，能成功触发并监控完整的Excel转换流程。
- [ ] **UI代码质量**：UI代码结构模块化，组件复用度高，符合Python代码规范，并通过静态检查。
- [ ] **用户体验**：关键用户操作（如开始运行、加载配置）有明确的成功/失败提示。
- [ ] **需求模糊点澄清**：所有需求模糊点（Ambiguities）在开发启动前均已形成书面决策，并获得关键干系人确认。
- [ ] **项目计划**：项目计划（含任务拆解、排期、依赖关系）清晰完整，并得到执行团队认可。
- [ ] **风险管理**：项目过程中识别的关键风险均有记录、评估和应对方案，无未管理的重大风险导致项目偏离。
- [ ] **最终交付**：所有要求的交付物（ADR、验收清单、证据链、审查产物、性能测试报告、更新文档）均已按时、按质产出，内容完整且符合规范。
- [ ] **验收测试通过**：重构后的模块成功通过所有验收测试，包括功能一致性验证、性能指标达成、CLI接口兼容性验证。
- [ ] **项目总结**：项目总结报告清晰阐述了项目成果、挑战、经验教训及后续建议。